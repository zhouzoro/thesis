"use strict";require(["esri/Map","esri/views/MapView","esri/layers/MapImageLayer","esri/layers/FeatureLayer","esri/PopupTemplate","esri/widgets/Legend","esri/widgets/Compass","esri/widgets/Compass/CompassViewModel","esri/widgets/Home","esri/widgets/Home/HomeViewModel","esri/widgets/BasemapToggle","esri/widgets/Popup","esri/tasks/QueryTask","esri/tasks/support/Query","esri/symbols/SimpleFillSymbol","dojo/domReady!"],function(e,t,i,n,o,s,a,r,d,c,l,u,p,h,g){function w(e){$("#esri_widgets_Attribution_0 > div.esri-attribution__sources").html(e.mapPoint.latitude+e.mapPoint.longitude)}var v=new e({basemap:"oceans"}),m=new t({container:"map-container",map:v,zoom:9,center:[121,33]});m.then(function(){v.on("mouse-move",w);var e="<label class='data-fid loader' data-fid='{FID}'>Loading...</label>",t=new a({viewModel:new r({view:m})},"compass");t.startup();var i=new d({viewModel:new c({view:m})},"home");i.startup();var u=new l({view:m,nextBasemap:"hybrid"},"basemap");u.startup();var p=new s({view:m});p.startup(),m.ui.add(p,"bottom-right");var h=function(){var t=["功能区划","确权数据","确权数据--配号来源","确权数据--用海一级类","确权数据--用海二级类","确权数据--用海方式"],i=[];i[1]=new n({id:t[1],url:"http://localhost:6080/arcgis/rest/services/用海信息/MapServer/1",popupTemplate:new o({title:"ID: {FID}",content:e})}),console.log(i[1]),v.add(i[1]);for(var s=2;6>s;s++){var a=new n({id:t[s],url:"http://localhost:6080/arcgis/rest/services/用海信息/MapServer/"+s,popupTemplate:new o({title:"ID: {FID}",content:e})});i[s]=a}return m.whenLayerView(i[1]).then(function(e){e.watch("updating",function(t){t||e.queryFeatures().then(function(e){console.log(e[0]);var t=g({color:"red",outline:{color:[128,128,128,.5],width:"0.5px"}});e.forEach(function(e,i){var n=e.attributes;n.ZIP+" ("+n.PO_NAME+")";e.symbol=t})})})}),{inviewIndex:1,on:!0,switchTo:function(e){console.log("switching"),console.log(this.inviewIndex),console.log(e),e!==this.inviewIndex&&(v.remove(i[this.inviewIndex]),console.log("switching"),v.add(i[e]),this.inviewIndex=e)},show:function(){v.add(i[this.inviewIndex]),this.on=!0},hide:function(){v.remove(i[this.inviewIndex]),this.on=!1},toggle:function(){this.on?(v.remove(i[this.inviewIndex]),this.on=!1):(v.add(i[this.inviewIndex]),this.on=!0)}}}(),f=function(){var e=new n({id:"功能区划",url:"http://localhost:6080/arcgis/rest/services/zoning/MapServer/0"});return{on:!1,toggle:function(){this.on?v.remove(e):(v.add(e),h.on&&(h.hide,h.show)),this.on=!this.on}}}();$("input.toggle.toggle-zoning").change(function(){f.toggle()}),$("input.toggle.toggle-auth").change(function(){h.toggle()}),$("select[name=authLyr]").change(function(){console.log($(this).val()),h.switchTo($(this).val())});var b=function(){var e=1;return function(){var t=$(".esri-popup-content")[0];if(1===e&&t.childElementCount>0){$(".esri-popup-content").unbind("DOMSubtreeModified");var i=$(".esri-popup-content").find(".data-fid.loader").data("fid");i&&$.get("http://localhost:3000/popup_content?id="+i,function(e){$(".esri-popup-content").html(e),$(".ui.dropdown").dropdown(),$(".popup-content-custom table").find("a").click(function(){var e=$(this).data("type"),t="SELECT `"+e+"` as label, count(`"+e+"` = `"+e+"`) as value FROM gis1.authorizing group by `"+e+"`";createChart(t,e)}),$(".esri-popup-content").bind("DOMSubtreeModified",b)}),e=0}t.childElementCount<1&&(e=1)}}();$(".esri-popup-content").bind("DOMSubtreeModified",b),m.on("click",function(e){w(e)})})});
//# sourceMappingURL=../maps/core.babeled.min.js.map
