"use strict";require(["esri/Map","esri/views/MapView","esri/layers/MapImageLayer","esri/layers/FeatureLayer","esri/PopupTemplate","esri/widgets/Legend","esri/widgets/Compass","esri/widgets/Compass/CompassViewModel","esri/widgets/Home","esri/widgets/Home/HomeViewModel","esri/widgets/BasemapToggle","esri/widgets/Popup","esri/tasks/QueryTask","esri/tasks/support/Query","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","esri/layers/GraphicsLayer","esri/Graphic","esri/geometry/Circle","esri/geometry/Point","esri/renderers/SimpleRenderer","esri/renderers/ClassBreaksRenderer","dojo/domReady!"],function(e,t,r,i,n,o,s,a,d,l,c,p,u,h,v,w,g,f,m,y,b,I){var x=new e({basemap:"oceans"}),M=new t({container:"map-container",map:x,zoom:9,center:[121,33]});M.then(function(){function e(){function e(e,t,r){return $("<a>").attr({"class":"result","data-popid":r}).append($("<div>").attr("class","content").append($("<div>").attr("class","title").text(e)).append($("<div>").attr("class","description").text(t))).click(function(){var e=$(this).data("popid");console.log(I.inviewIndex);var t=m[I.inviewIndex],r=new h;r.where="FID = "+e,r.returnGeometry=!0,r.outFields=["*"],x.reorder(t,100),t.queryFeatures(r).then(function(e){console.log(e),M.popup.open({features:[e.features[0]],location:e.features[0].geometry.centroid})})})}var t=$("#searchResult.results");t.addClass("visible");var r=$('input[name="search"');$("i.icon.remove").show(),$("i.icon.search").hide(),console.log("http://localhost:3000/search?q="+r.val()),$.get("http://localhost:3000/search?q="+r.val(),function(t){console.log(t);var r=$("#searchResult.results");r.find(".result").remove();var i=r.find(".projects"),n=r.find(".zones"),o=!0,s=!1,a=void 0;try{for(var d,l=t.rows[0][Symbol.iterator]();!(o=(d=l.next()).done);o=!0){var c=d.value;i.show(),$("a.csv1").show();var p="";for(var u in c)p=p+u+": "+c[u];p=p.substring(0,64)+"...",i.append(e(c["项目名称"],p,c["确权区域ID"]))}}catch(h){s=!0,a=h}finally{try{!o&&l["return"]&&l["return"]()}finally{if(s)throw a}}var v=!0,w=!1,g=void 0;try{for(var f,m=t.rows[1][Symbol.iterator]();!(v=(f=m.next()).done);v=!0){var y=f.value;n.show(),$("a.csv2").show();var p="";for(var b in y)p=p+b+": "+y[b];p=p.substring(0,64)+"...",n.append(e(y.id,p,y.id))}}catch(h){w=!0,g=h}finally{try{!v&&m["return"]&&m["return"]()}finally{if(w)throw g}}var I=r.find(".download-results"),x=t.csvs.split(",");I.find(".csv1").attr("href","http://localhost:3000/csv/"+x[0]),I.find(".csv2").attr("href","http://localhost:3000/csv/"+x[1]),I.show()})}$('input[name="search"').keyup(e).change(e),$("i.icon.search").click(e);var t='<table class="ui celled table"><tbody><tr><td>区域ID</td><td>{FID}</td></tr><tr><td>radius</td><td>{radius}</td></tr><tr><td>配号来源</td><td>{配号来源}</td></tr><tr><td>用海一级类</td><td>{用海一级类}</td></tr><tr><td>用海二级类</td><td>{用海二级类}</td></tr><tr><td>用海方式</td><td>{用海方式}</td></tr><tr><td class="projects">项目数量</td><td>*</td></tr></tbody></table>',r=new s({viewModel:new a({view:M})},"compass");r.startup();var p=new d({viewModel:new l({view:M})},"home");p.startup();var u=new c({view:M,nextBasemap:"hybrid"},"basemap");u.startup();var v=new o({view:M});v.startup(),M.ui.add(v,"bottom-right");var w=new i({id:"base",url:"http://localhost:6080/arcgis/rest/services/区域/MapServer/0"});x.add(w),x.reorder(w,0);var g={on:!0,toggle:function(){this.on?x.remove(w):(x.add(w),x.reorder(w,0)),this.on=!this.on}},f=["功能区划","确权数据","确权数据--配号来源","确权数据--用海一级类","确权数据--用海二级类","确权数据--用海方式"],m=[];m[1]=new i({id:f[1],outFields:["*"],url:"http://localhost:6080/arcgis/rest/services/用海信息/MapServer/1",popupTemplate:new n({title:"ID: {FID}",content:t})}),x.add(m[1]);for(var y=2;6>y;y++){var b=new i({id:f[y],outFields:["*"],url:"http://localhost:6080/arcgis/rest/services/用海信息/MapServer/"+y,popupTemplate:new n({title:"ID: {FID}",content:t})});m[y]=b}var I={inviewIndex:1,on:!0,switchTo:function(e){e!==this.inviewIndex&&(x.remove(m[this.inviewIndex]),x.add(m[e]),x.reorder(m[e],1),this.inviewIndex=e)},show:function(){x.add(m[this.inviewIndex]),x.reorder(m[this.inviewIndex],1),this.on=!0},hide:function(){x.remove(m[this.inviewIndex]),this.on=!1},toggle:function(){this.on?(x.remove(m[this.inviewIndex]),this.on=!1):(x.add(m[this.inviewIndex]),x.reorder(m[this.inviewIndex],1),this.on=!0)}};m[1].then(function(){}),$("input.toggle.toggle-zoning").change(function(){g.toggle()}),$("input.toggle.toggle-auth").change(function(){I.toggle()}),$("select[name=authLyr]").change(function(){I.switchTo($(this).val())});var S=function(){var e=1;return function(){var t=$(".esri-popup-content")[0];if(1===e&&t.childElementCount>0){$(".esri-popup-content").unbind("DOMSubtreeModified");var r=$(".esri-popup-content").find(".data-fid.loader").data("fid");r&&$.get("http://localhost:3000/popup_content?id="+r,function(e){$(".esri-popup-content").html(e),$(".ui.dropdown").dropdown(),$(".popup-content-custom table").find("a").click(function(){var e=$(this).data("type"),t="SELECT `"+e+"` as label, count(`"+e+"` = `"+e+"`) as value FROM gis1.authorizing group by `"+e+"`";createChart(t,e)}),$(".esri-popup-content").bind("DOMSubtreeModified",S)}),e=0}t.childElementCount<1&&(e=1)}}()})});
//# sourceMappingURL=D:/inetpub/wwwroot/javascripts/maps/core.babeled.min.js.map
